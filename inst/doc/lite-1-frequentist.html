<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul Northrop" />

<meta name="date" content="2024-07-17" />

<title>Frequentist Likelihood-Based Inference for Time Series Extremes</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Frequentist Likelihood-Based Inference for
Time Series Extremes</h1>
<h4 class="author">Paul Northrop</h4>
<h4 class="date">2024-07-17</h4>


<div id="TOC">
<ul>
<li><a href="#cheeseboro-wind-gust-data" id="toc-cheeseboro-wind-gust-data">Cheeseboro wind gust data</a></li>
<li><a href="#inferences-for-model-parameters" id="toc-inferences-for-model-parameters">Inferences for model
parameters</a></li>
<li><a href="#inferences-for-return-levels" id="toc-inferences-for-return-levels">Inferences for return
levels</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>The <strong>lite</strong> package performs likelihood-based inference
for stationary time series extremes. This vignette concentrates on
frequentist inference, using maximum likelihood estimation. See the
vignette <a href="lite-2-bayesian.html">Bayesian Likelihood-Based
Inference for Time Series Extremes</a> for information about Bayesian
inference.</p>
<p>The general approach follows <span class="citation">Fawcett and
Walshaw (2012)</span>. There are 3 independent parts to the inference,
all performed using maximum likelihood estimation.</p>
<ol style="list-style-type: decimal">
<li>A Bernoulli<span class="math inline">\((p_u)\)</span> model for
whether a given observation exceeds the threshold <span class="math inline">\(u\)</span>.</li>
<li>A generalised Pareto, GP<span class="math inline">\((\sigma_u,
\xi)\)</span>, model for the marginal distribution of threshold
excesses.</li>
<li>The <span class="math inline">\(K\)</span>-gaps model for the
extremal index <span class="math inline">\(\theta\)</span>, based on
inter-exceedance times.</li>
</ol>
<p>For parts 1 and 2, inferences based on a mis-specified independence
log-likelihood are adjusted to account for clustering in the data. The
adjustment does not affect the point estimates of <span class="math inline">\((p_u, \sigma_u, \xi)\)</span> but it ensures that
estimates of uncertainty associated with these estimates account for
dependence in the data. Otherwise, uncertainty in these parameters will
tend to be underestimated.</p>
<p>Here, we follow <span class="citation">Chandler and Bate
(2007)</span> to estimate adjusted log-likelihood functions for <span class="math inline">\(p_u\)</span> and for (<span class="math inline">\(\sigma_u, \xi\)</span>), using the
<strong>chandwich</strong> package <span class="citation">(Northrop and
Chandler 2021)</span>. For details of the log-likelihood adjustments see
the <a href="https://cran.r-project.org/package=chandwich">introductory
vignette for the chandwich package</a>. We will see below that although
there is more than one way to perform this adjustment there is a strong
argument in favour of the so-called <strong>vertical</strong>
adjustment. A vertical adjustment adjusts on the log-likelihood scale,
thereby respecting constraints on the parameter values, whereas the
<strong>horizontal</strong> adjustment adjusts on the parameter
scale.</p>
<p>For part 3, the methodology described in <span class="citation">Süveges and Davison (2010)</span> is used, implemented
by the function <code>kgaps</code> in the <strong>exdex</strong> package
<span class="citation">(Northrop and Christodoulides 2022)</span>. The
<span class="math inline">\(K\)</span>-gaps model involves a tuning
parameter <span class="math inline">\(K\)</span> that defines how
distant in time threshold exceedances need to be before they are
considered to be from separate clusters of threshold exceedances. In
addition to providing an estimator of <span class="math inline">\(\theta\)</span>, <span class="citation">Süveges
and Davison (2010)</span> provides a diagnostic to inform the choice of
<span class="math inline">\(K\)</span> and the threshold <span class="math inline">\(u\)</span>. We use this diagnostic below, but it
would also be advisable also to examine graphically the effect of <span class="math inline">\((u, K)\)</span> on extremes value inferences, by
plotting point estimates and confidence intervals for key quantities
such as the generalised Pareto shape parameter <span class="math inline">\(\xi\)</span> or return levels of interest.</p>
<p>The (adjusted) log-likelihoods produced in parts 1, 2 and 3 are
combined to form a log-likelihood for <span class="math inline">\((p_u,
\sigma_u, \xi, \theta)\)</span> from which extreme value inferences can
be made.</p>
<div id="cheeseboro-wind-gust-data" class="section level2">
<h2>Cheeseboro wind gust data</h2>
<p>We use an example dataset to illustrate the use of the two main
functions in <strong>lite</strong>, that is, <code>flite</code> and
<code>returnLevel</code>. The 744 by 10 matrix <code>cheeseboro</code>,
available from the <strong>exdex</strong> package, contains hourly
maximum wind gusts (in miles per hour) recorded at the Cheeseboro
weather station near Thousand Oaks, Southern California, USA during the
month of January over the period 2000-2009. Column <span class="math inline">\(i\)</span> contains the hourly values for year
<span class="math inline">\(1999+i\)</span>. These data are sourced from
the <a href="https://raws.dri.edu/cgi-bin/rawMAIN.pl?caCCHB">Cheeseboro
page</a> of the Remote Automated Weather Stations USA Climate Archive.
The following plot shows the general behaviour of these data.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For estimating <span class="math inline">\((p_u, \sigma_u,
\xi)\)</span> we treat observations from different years as being in
separate clusters. In the code below we do not need to set the argument
<code>cluster</code> explicitly because when the data are supplied as a
matrix the function <code>flite</code> sets <code>cluster</code>
automatically to achieve this. A total of 42 observations are missing in
<code>cheeseboro</code>. This causes no problems for inferences about
<span class="math inline">\((p_u, \sigma_u, \xi)\)</span>. For making
inferences about <span class="math inline">\(\theta\)</span> using the
<span class="math inline">\(K\)</span>-gaps model the <code>kgaps</code>
function splits the data further into sequences of non-missing values
and constructs the sample <span class="math inline">\(K\)</span>-gaps
separately for each sequence.</p>
</div>
<div id="inferences-for-model-parameters" class="section level2">
<h2>Inferences for model parameters</h2>
<p>We need to choose values for the tuning parameters threshold <span class="math inline">\(u\)</span> and <span class="math inline">\(K\)</span>-gaps run parameter <span class="math inline">\(K\)</span>. There is no definitive way to do this
but the information matrix test developed in <span class="citation">Süveges and Davison (2010)</span> can help to make this
choice. Based on the <span class="math inline">\(K\)</span>-gaps section
of the <a href="https://cran.r-project.org/package=exdex">introductory
vignette for the exdex package</a> we choose <span class="math inline">\(u = 45\)</span>mph and <span class="math inline">\(K = 3\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(lite)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>cdata <span class="ot">&lt;-</span> exdex<span class="sc">::</span>cheeseboro</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Each column of the matrix cdata corresponds to data from a different year</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># flite() sets cluster automatically to correspond to column (year)</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>cfit <span class="ot">&lt;-</span> <span class="fu">flite</span>(cdata, <span class="at">u =</span> <span class="dv">45</span>, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">summary</span>(cfit)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co">#&gt; flite(data = cdata, u = 45, k = 3)</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. Error</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#&gt; p[u]      0.02771   0.005988</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co">#&gt; sigma[u]  9.27400   2.071000</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co">#&gt; xi       -0.09368   0.084250</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="co">#&gt; theta     0.24050   0.023360</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">summary</span>(cfit, <span class="at">adjust =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; flite(data = cdata, u = 45, k = 3)</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;          Estimate Std. Error</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; p[u]      0.02771   0.001908</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; sigma[u]  9.27400   0.858100</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; xi       -0.09368   0.061040</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; theta     0.24050   0.023360</span></span></code></pre></div>
<p>The effect of the adjustment of the log-likelihood for clustering is
to increase the estimated standard errors for the parameters <span class="math inline">\(p_u\)</span> and <span class="math inline">\((\sigma_u, \xi)\)</span> in comparison to those
obtained with no adjustment.</p>
<p>A plot method for objects inheriting from class <code>&quot;flite&quot;</code>
enables us to inspect the log-likelihood functions for <span class="math inline">\(p_u\)</span>, <span class="math inline">\((\sigma_u, \xi)\)</span> and <span class="math inline">\(\theta\)</span>. This first set of plots use the
default vertical adjustment to the log-likelihoods for <span class="math inline">\(p_u\)</span> and <span class="math inline">\((\sigma_u, \xi)\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot</span>(cfit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The line superimposed on the on the plot on the top right shows the
boundary of the log-likelihood imposed by the constraint <span class="math inline">\(\xi &gt; -\sigma_u / x_{(n)}\)</span>, where <span class="math inline">\(x_{(n)}\)</span> is the largest threshold excess.
Using the vertical adjustment ensures that this constraint is respected
after adjustment. However, if we use one of the horizontal adjustments,
<strong>cholesky</strong> or <strong>spectral</strong>, then the
adjusted log-likelihood has non-zero density values outside of the
correct support. This is why the vertical adjustment is the default.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot</span>(cfit, <span class="at">which =</span> <span class="st">&quot;gp&quot;</span>, <span class="at">adj_type =</span> <span class="st">&quot;spectral&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="inferences-for-return-levels" class="section level2">
<h2>Inferences for return levels</h2>
<p>The <span class="math inline">\(m\)</span>-year return level is the
value that is exceeded with probability <span class="math inline">\(1/m\)</span> in any given year. To infer this from
time series data we need to take account of the (intended) sampling
frequency of the data. In the context of the Cheeseboro data, a year is
effectively one month because we are making inferences about extremal
behaviour in January. If there are no missing values then there are
<span class="math inline">\(31 \times 24 = 744\)</span> hourly values
per January. We denote this by <span class="math inline">\(n_y\)</span>
(number of observations per year).</p>
<p>The <span class="math inline">\(m\)</span>-year return level is given
by <span class="math display">\[x_m = u+\frac{\sigma_u}{\xi} \left[
p_u^\xi \left\{ 1-\left( 1-\displaystyle \frac1m\right)^{1/n_{y}\theta}
\right\}^{-\xi} - 1 \right].\]</span></p>
<p>If <span class="math inline">\(m n_y \theta\)</span> is large then
<span class="math display">\[x_m \approx u+\frac{\sigma_u}{\xi} \left[
(m \, n_{y}\, \theta \, p_u)^\xi  -  1 \right].\]</span> The
<code>returnLevel</code> function performs inferences about return
levels. It uses the former expression for <span class="math inline">\(x_m\)</span>. By default it calculates two types
of (95%) confidence intervals: (a) intervals based on approximate
large-sample normality of the maximum likelihood estimator for return
level, which are symmetric about the point estimate, and (b) profile
likelihood-based intervals based on an (adjusted) log-likelihood.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>rl <span class="ot">&lt;-</span> <span class="fu">returnLevel</span>(cfit, <span class="at">m =</span> <span class="dv">100</span>, <span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">ny =</span> <span class="dv">31</span> <span class="sc">*</span> <span class="dv">24</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">summary</span>(rl)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; returnLevel(x = cfit, m = 100, level = 0.95, ny = 31 * 24)</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;         Estimate Std. Error</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; m = 100 88.61986   9.600889</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>rl</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; returnLevel(x = cfit, m = 100, level = 0.95, ny = 31 * 24)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; MLE and 95% confidence limits for the 100-year return level</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; Normal interval:</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  lower     mle   upper  </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;  69.80   88.62  107.44  </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; Profile likelihood-based interval:</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;  lower     mle   upper  </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;  75.89   88.62  125.43</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(rl)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-CB2007" class="csl-entry">
Chandler, R. E., and S. Bate. 2007. <span>“Inference for Clustered Data
Using the Independence Loglikelihood.”</span> <em>Biometrika</em> 94
(1): 167–183. doi:<a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</div>
<div id="ref-FW2012" class="csl-entry">
Fawcett, L., and D. Walshaw. 2012. <span>“Estimating Return Levels from
Serially Dependent Extremes.”</span> <em>Environmetrics</em> 23 (3):
272–283. doi:<a href="https://doi.org/10.1002/env.2133">10.1002/env.2133</a>.
</div>
<div id="ref-chandwich" class="csl-entry">
Northrop, P. J., and R. E. Chandler. 2021. <em><span class="nocase">c</span>handwich: Chandler-Bate Sandwich Loglikelihood
Adjustment</em>. <a href="https://CRAN.R-project.org/package=chandwich">https://CRAN.R-project.org/package=chandwich</a>.
</div>
<div id="ref-exdex" class="csl-entry">
Northrop, P. J., and C. Christodoulides. 2022. <em><span class="nocase">e</span>xdex: Estimation of the Extremal Index</em>. <a href="https://CRAN.R-project.org/package=exdex">https://CRAN.R-project.org/package=exdex</a>.
</div>
<div id="ref-SD2010" class="csl-entry">
Süveges, M., and A. C. Davison. 2010. <span>“Model Misspecification in
Peaks over Threshold Analysis.”</span> <em>The Annals of Applied
Statistics</em> 4 (1): 203–221. doi:<a href="https://doi.org/10.1214/09-AOAS292">10.1214/09-AOAS292</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
